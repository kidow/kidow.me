---
title: Create Toast Component
date: 2022-12-09
description: There was a case where a notification message had to be displayed to users while creating a Cuddy for the developer chat room.
thumbnail: https://kidow.me/api/image?id=fguze8xin4
keywords: React, Component, Toast, CustomEvent
---

import { Comment, Figure } from 'components'
import { BackTop, Frontmatter, ShareButtons } from 'containers'

<Frontmatter />
<BackTop />

ê°œë°œì ì±„íŒ…ë°© [ì»¤ë””](https://coddee.dev)ë¥¼ ë§Œë“¤ë©´ì„œ ìœ ì €ë“¤ì—ê²Œ ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ ë„ì›Œì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

- í”„ë¡œí•„ ì •ë³´ë¥¼ ìˆ˜ì •í–ˆì„ ë•Œ **ì„±ê³µ** ë©”ì‹œì§€ë¥¼ ë„ìš´ë‹¤ë˜ì§€,
- ë¡œê·¸ì¸í•˜ì§€ ì•Šê³  ì±„íŒ…ì„ ì¹˜ë ¤í•  ë•Œ ë¡œê·¸ì¸ì„ í•˜ë¼ëŠ” **ì•ˆë‚´** ë©”ì‹œì§€ë¥¼ ë„ìš´ë‹¤ë˜ì§€,
- ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ì´ë¥¼ ì•Œë¦¬ê¸° ìœ„í•œ **ì—ëŸ¬** ë©”ì‹œì§€ë¥¼ ë„ì›Œì•¼ í•  ë•Œê°€ ê·¸ë ‡ì£ .

## ê²°ê³¼

ë¨¼ì € ê²°ê³¼ë¬¼ë¶€í„° ë³´ì—¬ë“œë¦¬ë©´ ì´ë ‡ìŠµë‹ˆë‹¤.

<Figure
  caption="ìƒë‹¨ì— 2ê°œì˜ ë©”ì‹œì§€ê°€ ë³´ì´ì‹œë‚˜ìš”?"
  image="/contents/15/example.png"
/>

### ì½”ë“œ

```tsx filename="containers/Toast/index.tsx"
import { useCallback, useEffect } from 'react'
import type { FC } from 'react'
import { EventListener, useObjectState } from 'services'
import { createPortal } from 'react-dom'
import {
  CheckCircleIcon,
  ExclamationCircleIcon,
  ExclamationTriangleIcon,
  InformationCircleIcon
} from '@heroicons/react/24/outline'

export interface Props {}
interface State {
  list: Array<{
    id: string
    message: string
    type: NToast.Type
  }>
}

const Toast: FC<Props> = () => {
  const [{ list }, setState] = useObjectState<State>({ list: [] })

  const onMessage = useCallback(
    ({ detail }: any) =>
      setState({
        list: !!detail.id
          ? list.filter((item) => item.id !== detail.id)
          : [
              ...list,
              {
                id: Math.random().toString(36).slice(2),
                message: detail?.message,
                type: detail.type
              }
            ]
      }),
    [list.length]
  )

  useEffect(() => {
    EventListener.once('toast', onMessage)
  }, [list.length])

  if (!list.length) return null
  return createPortal(
    <div role="alertdialog">
      <div className="fixed top-4 left-1/2 z-50 -translate-x-1/2 space-y-4">
        {list.map((item) => (
          <div
            className="animate-fade-up w-72 cursor-pointer rounded bg-white py-2 px-4 dark:bg-black"
            id={item.id}
            key={item.id}
            onClick={() => EventListener.emit('toast', { id: item.id })}
            role="alert"
            style={{
              boxShadow:
                'rgba(50, 50, 93, 0.25) 0px 13px 27px -5px, rgba(0, 0, 0, 0.3) 0px 8px 16px -8px'
            }}
          >
            <div className="flex items-center gap-2">
              <span>
                {item.type === 'success' && (
                  <CheckCircleIcon className="h-5 w-5 text-green-500" />
                )}
                {item.type === 'info' && (
                  <InformationCircleIcon className="h-5 w-5 text-blue-500" />
                )}
                {item.type === 'warn' && (
                  <ExclamationTriangleIcon className="h-5 w-5 text-amber-500" />
                )}
                {item.type === 'error' && (
                  <ExclamationCircleIcon className="h-5 w-5 text-red-500" />
                )}
              </span>
              <span className="select-none text-sm">{item?.message}</span>
            </div>
          </div>
        ))}
      </div>
    </div>,
    document.body
  )
}

export default Toast
```

### ì „ì œ ì¡°ê±´

ë¨¼ì € ë‹¤ìŒê³¼ ê°™ì€ ì¡°ê±´ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤.

1. ì „ì—­ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
2. í´ë¦­ ì‹œ í•´ë‹¹ í† ìŠ¤íŠ¸ëŠ” ì‚¬ë¼ì§„ë‹¤.
3. í† ìŠ¤íŠ¸ëŠ” ìœ„ì¹˜ê°€ ê³ ì •ë˜ì–´ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ì´ë¯€ë¡œ ë…ë¦½ì ì¸ DOMìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•œë‹¤.

ì—¬ê¸°ì„œ UIì— ëŒ€í•œ ì´ì•¼ê¸°ëŠ” ê±´ë„ˆë›°ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

### ì „ì—­ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ â˜ï¸

ë³´í†µ Reactê°™ì€ SPAì—ì„œ ì „ì—­ ìƒíƒœ ê´€ë¦¬ë¥¼ ì—¼ë‘í•˜ë©´ Reduxê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìƒê°í•˜ê¸° ë§ˆë ¨ì¸ë°, ì‚¬ì‹¤ Windowì—ì„œ ë‚´ì¥ëœ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ë„ ì¶©ë¶„í•©ë‹ˆë‹¤.
ë°”ë¡œ `CustomEvent` ë¼ëŠ” ê²ƒì¸ë°ìš”,

ìš°ë¦¬ê°€ addEventListenerì²˜ëŸ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í•  ë•Œ, windowë‚˜ documentì— ë‚´ì¥ëœ ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²Œ ì•„ë‹Œ ë‚˜ë§Œì˜ ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. ë˜í•œ ë³€ìˆ˜ë¥¼ ì¸ìë¡œ ë‹´ì•„ ë³´ë‚¼ ìˆ˜ë„ ìˆì–´ì„œ ì „ì—­ ìƒíƒœ ê´€ë¦¬ë¥¼ ëŒ€ì²´í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

[ì°¸ì¡° ë§í¬](https://developer.mozilla.org/ko/docs/Web/API/CustomEvent/CustomEvent)

ì˜ˆì „ë¶€í„° ìˆë˜ ê¸°ëŠ¥ì´ì—ˆì§€ë§Œ IEì—ì„œ í˜¸í™˜ë˜ì§€ ì•Šì•„ ë„ë¦¬ ì‚¬ìš©ë˜ì§€ ëª»í–ˆì§€ë§Œ IEê°€ ìƒì„ ë§ˆê°í•˜ë©´ì„œ ì ì  ì ê·¹ì ìœ¼ë¡œ ë„ì…ì´ ë˜ê³  ìˆëŠ” ì¶”ì„¸ì…ë‹ˆë‹¤.

<Figure
  caption="ê±°ì˜ ëª¨ë“  ë¸Œë¼ìš°ì €ë¥¼ ì§€ì›í•œë‹¤."
  image="/contents/15/compatibility.png"
/>

ì €ëŠ” CustomEventë¥¼ ë‹¤ìŒê³¼ ê°™ì€ í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ì„œ ë‚´ë³´ëƒˆìŠµë‹ˆë‹¤.

```ts
export const add = (
  type: string,
  listener: EventListenerOrEventListenerObject
) => window.addEventListener(type, listener)

export const remove = (
  type: string,
  listener: EventListenerOrEventListenerObject
) => window.removeEventListener(type, listener)

export const once = (type: string, listener: any) => {
  const emitOnce = (event: any) => {
    listener(event)
    remove(type, emitOnce)
  }

  add(type, emitOnce)
}

export function emit<T>(type: string, detail?: T) {
  const event = new CustomEvent<T>(type, { detail })
  window.dispatchEvent(event)
}
```

ê°ê°ì˜ í•¨ìˆ˜ì— ëŒ€í•´ ì„¤ëª…í•˜ìë©´

- add: addEventListenerì™€ ê°™ì€ ì—­í• 
- remove: removeEventListenerì™€ ê°™ì€ ì—­í• 
- once: ì‹¤í–‰ ìˆœê°„ addí•´ì„œ í•œ ë²ˆë§Œ ì‹¤í–‰í•˜ê³  ë‹¤ì‹œ removeí•˜ëŠ” ì—­í• 
- emit: ë“±ë¡í•œ ì´ë²¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜. ìƒˆë¡œ ë§Œë“¤ì–´ì§„ ì´ë²¤íŠ¸ë¥¼ CustomEventë¼ëŠ” ìƒì„±ì í•¨ìˆ˜ì— ì¸ìë¡œ ë„£ê³  `dispatchEvent`ë¼ëŠ” í•¨ìˆ˜ë¥¼ í†µí•´ ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤. ë§Œì•½ addë¡œ ì´ë²¤íŠ¸ê°€ ë“±ë¡ë˜ì§€ ì•Šì•˜ë‹¤ë©´ emitì€ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ìœ„ì— Toast Componentì—ì„œ ë‹¤ì‹œ ë³´ì‹œë©´

```ts
const onMessage = useCallback(
  ({ detail }: any) =>
    setState({
      list: !!detail.id
        ? list.filter((item) => item.id !== detail.id)
        : [
            ...list,
            {
              id: Math.random().toString(36).slice(2),
              message: detail?.message,
              type: detail.type
            }
          ]
    }),
  [list.length]
)

useEffect(() => {
  EventListener.once('toast', onMessage)
}, [list.length])
```

### í´ë¦­ ì‹œ ì‚¬ë¼ì§„ë‹¤ ğŸ’¥

ìœ„ì˜ onMessageë¼ëŠ” í•¨ìˆ˜ë¥¼ ë³´ì‹œë©´ `detail`ì´ë¼ëŠ” ê°’ì„ êº¼ë‚´ ì“°ê³  ìˆëŠ”ë°, ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ëŠ” ì¸ìë¥¼ ë‹´ì•„ì„œ ë³´ë‚¼ ë•Œ ë§Œë“œì‹œ detailì´ë¼ëŠ” ì†ì„±ì— ë³´ë‚¸ ì¸ìë“¤ì´ ë‹´ì•„ì ¸ì„œ ì˜¤ê²Œ ë©ë‹ˆë‹¤.

Toastì˜ ê²½ìš° ëœë¤ ìƒì„±í•œ ë‚œìˆ˜ë¥¼ idë¡œ ë¶€ì—¬í•´ì„œ, idë¥¼ ì¸ìì— ë‹´ì•„ ë³´ë‚´ëŠ” ê²½ìš°ëŠ” ì—¬ëŸ¬ ê°œì˜ í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ì¤‘ íŠ¹ì • í† ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ í´ë¦­í•œ ê²½ìš°ì´ê¸° ë•Œë¬¸ì— filterë¥¼ í†µí•´ ì œì™¸í•˜ê³ , ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš°ëŠ” ìƒˆë¡œ ìƒì„±í•˜ëŠ” ê²½ìš°ì´ê¸° ë•Œë¬¸ì— ëª©ë¡ì—ì„œ ê°€ì¥ ë’¤ì— ìƒˆë¡œ ì¶”ê°€í•˜ë„ë¡ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.

### ToastëŠ” ë…ë¦½ì ì¸ DOMìœ¼ë¡œì„œ ì²˜ë¦¬

ToastëŠ” ê³ ì •ëœ ìœ„ì¹˜ì—ì„œ ë‚˜íƒ€ë‚˜ê¸° ë•Œë¬¸ì— ë…ë¦½ì ì¸ ìœ„ì¹˜ì— ìˆì–´ì•¼ í•œë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤. Reactì˜ `createPortal`ì„ ì‚¬ìš©í•˜ì—¬ `document.body` í•˜ìœ„ë¡œ ìƒˆ DOMì„ ìƒì„±í•´ì¤ë‹ˆë‹¤.

### toast í•¨ìˆ˜

ìœ„ì—ì„œëŠ” Toast ì»´í¬ë„ŒíŠ¸ì™€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë§Œ ë§Œë“¤ì—ˆê³ , ì •ì‘ ì´ë²¤íŠ¸ë¥¼ ë³´ë‚´ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì§€ ì•Šì•˜ëŠ”ë°ìš”, ì €ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.

```typescript
export const toast = {
  success: (message: string) =>
    EventListener.emit<NToast.Emit>('toast', { message, type: 'success' }),
  info: (message: string) =>
    EventListener.emit<NToast.Emit>('toast', { message, type: 'info' }),
  warn: (message: string) =>
    EventListener.emit<NToast.Emit>('toast', { message, type: 'warn' }),
  error: (message: string) =>
    EventListener.emit<NToast.Emit>('toast', { message, type: 'error' })
}
```

ìœ„ í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•©ë‹ˆë‹¤.

```ts
import { toast } from 'services'

toast.success('ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.')
toast.info('ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.')
toast.error('ì£„ì†¡í•©ë‹ˆë‹¤. ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')
```

## ì •ë¦¬

- `window.CustomEvent` ë•ë¶„ì— ì „ì—­ì—ì„œ Toast ê°™ì€ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ë£¨ê¸° ìˆ˜ì›”í•´ì¡Œë‹¤.
- `createPortal`ì„ í†µí•´ ì „ì—­ ì»´í¬ë„ŒíŠ¸ë¥¼ ë³„ê°œì˜ DOMìœ¼ë¡œ ì·¨ê¸‰í•˜ì—¬ CSS ì¶©ëŒì„ ìµœëŒ€í•œ ë°©ì§€ ê°€ëŠ¥

<ShareButtons />
<Comment />
